<!DOCTYPE html>
<html lang="en-us">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width,minimum-scale=1">
  <meta name="generator" content="Hugo 0.113.0">

  <title>Konfiguracja LVM | techfreak blog</title>
  <meta name="description"
        content="Linux network drony drukarki 3d elektronika">

  
  <meta name="robots" content="index, follow">
  

  

  
  
  
  <link href="/output/css/main.dd99284b3fb0195f16b300b67e52945c9480f0a2ee3e1e398e0c993696093d12.css" integrity="sha256-3ZkoSz&#43;wGV8WswC2flKUXJSA8KLuPh45jgyZNpYJPRI=" rel="stylesheet" crossorigin="anonymous">
  <link href='https://fonts.googleapis.com/css?family=Raleway:400,200,600' rel='stylesheet' type='text/css'>
  <meta property="og:title" content="Konfiguracja LVM" />
<meta property="og:description" content="Bardzo ciekawym i nie aż tak skomplikowanym tematem są LVM czyli Logical Volume Manager. Jest to bardzo elastyczny mechanizm do zarządzania przestrzenią dyskową. Poniżej przedstawiam parę podstawowych komend którymi sam się posługuję.
Poniżej są też ćwiczenia z konkretnych przypadków
Zmniejszanie dysku
Rozszerzanie dodawanie nowego dysku do wolumen grupy" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://techfreak.pl/konfiguracja-lvm/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2012-10-06T11:50:06+00:00" />
<meta property="article:modified_time" content="2012-10-06T11:50:06+00:00" />
<meta itemprop="name" content="Konfiguracja LVM">
<meta itemprop="description" content="Bardzo ciekawym i nie aż tak skomplikowanym tematem są LVM czyli Logical Volume Manager. Jest to bardzo elastyczny mechanizm do zarządzania przestrzenią dyskową. Poniżej przedstawiam parę podstawowych komend którymi sam się posługuję.
Poniżej są też ćwiczenia z konkretnych przypadków
Zmniejszanie dysku
Rozszerzanie dodawanie nowego dysku do wolumen grupy"><meta itemprop="datePublished" content="2012-10-06T11:50:06+00:00" />
<meta itemprop="dateModified" content="2012-10-06T11:50:06+00:00" />
<meta itemprop="wordCount" content="1813">
<meta itemprop="keywords" content="bash,lvm,vmware," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Konfiguracja LVM"/>
<meta name="twitter:description" content="Bardzo ciekawym i nie aż tak skomplikowanym tematem są LVM czyli Logical Volume Manager. Jest to bardzo elastyczny mechanizm do zarządzania przestrzenią dyskową. Poniżej przedstawiam parę podstawowych komend którymi sam się posługuję.
Poniżej są też ćwiczenia z konkretnych przypadków
Zmniejszanie dysku
Rozszerzanie dodawanie nowego dysku do wolumen grupy"/>

    
<script type="application/javascript">
var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
var doNotTrack = (dnt == "1" || dnt == "yes");
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-43800014-1', 'auto');
	ga('set', 'anonymizeIp', true);
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  

  
</head>

<body class="bg-gray-800 font-sans text-gray-400 subpixel-antialiased flex flex-col h-screen justify-between tracking-wide">
  <header class="bg-gray-700 py-3">
    <div class="container flex justify-between items-center flex-wrap">
  <div class="text-lg font-bold">
    <a href="/">
      
      techfreak blog
      
    </a>
  </div>
  <div class="flex items-center flex-wrap">
    

    
    <ul class="flex items-center flex-wrap">
      
      <li class="ml-4">
        <a class="hover:text-white" href="/categories/drony" title="Drony page">Drony</a>
      </li>
      
      <li class="ml-4">
        <a class="hover:text-white" href="/categories/drukarki-3d" title="Drukarki 3D page">Drukarki 3D</a>
      </li>
      
      <li class="ml-4">
        <a class="hover:text-white" href="/categories/elektronika" title="Elektronika page">Elektronika</a>
      </li>
      
      <li class="ml-4">
        <a class="hover:text-white" href="/categories/linux" title="Linux page">Linux</a>
      </li>
      
      <li class="ml-4">
        <a class="hover:text-white" href="/categories/network" title="Network page">Network</a>
      </li>
      
      <li class="ml-4">
        <a class="hover:text-white" href="/tags/nettemp" title="Nettemp page">Nettemp</a>
      </li>
      
      <li class="ml-4">
        <a class="hover:text-white" href="/page/contact/" title="Kontakt page">Kontakt</a>
      </li>
      
      <li class="ml-4">
        <a class="hover:text-white" href="/page/about/" title="About page">About</a>
      </li>
      
    </ul>
    
  </div>
</div>

  </header>
  
  <main class="container mb-auto mt-20">
  
  <article>
    <header class="text-center py-20">
      <h1 class="text-5xl pb-2">Konfiguracja LVM</h1>

      <div class="flex place-content-center">
        
        <p class="pr-5">
        By <strong>
          
          Przemek
          
        </strong> 
        </p>
        

        <time datetime="2012-10-06T11:50:06Z">
          October 6, 2012
        </time>
      </div>
    </header>

    <section>
      <p>Bardzo ciekawym i nie aż tak skomplikowanym tematem są LVM czyli <strong>Logical Volume Manager.</strong> Jest to bardzo elastyczny mechanizm do zarządzania przestrzenią dyskową. Poniżej przedstawiam parę podstawowych komend którymi sam się posługuję.</p>
<p>Poniżej są też ćwiczenia z konkretnych przypadków</p>
<p><a href="//techfreak.pl/konfiguracja-lvm#Zmniejszanie_dysku">Zmniejszanie dysku</a><br>
<a href="//techfreak.pl/konfiguracja-lvm#Rozszerzanie_dodawanie_nowego_dysku_do_wolumen_grupy">Rozszerzanie dodawanie nowego dysku do wolumen grupy</a></p>
<h3 id="tworzenie-lvm">Tworzenie LVM</h3>
<p>Dostępne partycje:</p>
<pre class="lang:default highlight:0 decode:true">/dev/sda1 /dev/sda2 /dev/sda3</pre>
<p>Zainicjowanie fizycznych partycji do używania LVM:</p>
<pre class="lang:default highlight:0 decode:true">pvcreate /dev/sda1
pvcreate /dev/sda2
pvcreate /dev/sda3</pre>
<p>Wyświetlanie atrybutów fizycznych wolumenów:</p>
<pre class="lang:default highlight:0 decode:true">pvdispaly & pvs</pre>
<p>Tworzenie grupy wolumenu:</p>
<pre class="lang:default highlight:0 decode:true">vgcreate vdysk /dev/sda1 /dev/sda2 /dev/sda3</pre>
<p>lub</p>
<p>(gdzie PE – Physical Extents będzie wynosił 32M, domyślnie 4M)</p>
<pre class="lang:default highlight:0 decode:true">vgcreate -s 32 vdysk /dev/sda1 /dev/sda2 /dev/sda3</pre>
<p>Wyświetlanie atrybutów grup wolumenów:</p>
<pre class="lang:default highlight:0 decode:true">vgdisplay & vgs</pre>
<p>Tworzenie logicznego wolumenu w grupie wolumenu:</p>
<pre class="lang:default highlight:0 decode:true">lvcreate -L 32M -n part1 vdysk</pre>
<p>Tworzenie systemu pików na logicznym wolumenie:</p>
<pre class="lang:default highlight:0 decode:true">mkfs.ext4 /dev/vdysk/part1</pre>
<p>Wyświetlanie atrybutów logicznych wolumenów:</p>
<pre class="lang:default highlight:0 decode:true">lvdisplay & lvs</pre>
<p>Tworzenie katalogu i montowanie:</p>
<pre class="lang:default highlight:0 decode:true">mkdir /lvm
mount /dev/vdysk/part1 /lvm</pre>
<p>lub</p>
<pre class="lang:default highlight:0 decode:true">mount /dev/mapper/vdysk-part1</pre>
<h3 id="powiększanie-lvm">Powiększanie LVM</h3>
<p>Wyświetlanie atrybutów grup wolumenów:</p>
<pre class="lang:default highlight:0 decode:true">vgs</pre>
<p>Rozszerzenie logicznych wolumenów o 12M:</p>
<pre class="lang:default highlight:0 decode:true">lvextend -L +12M /dev/vdysk/part1</pre>
<p>lub</p>
<p>Rozszerzenie logicznych wolumenów o 4 jednostki PE:</p>
<pre class="lang:default highlight:0 decode:true">lvextend -l +4 /dev/vdysk/part1</pre>
<p>lub o 50%</p>
<pre>lvextend -l +50%FREE /dev/vdysk/part1</pre>
<p>Rozszerzanie systemy plików:</p>
<pre class="lang:default highlight:0 decode:true">resize2fs /dev/vdysk/part1</pre>
<p>Sprawdzanie wielkości partycji:</p>
<pre class="lang:default highlight:0 decode:true">df -h</pre>
<h3 id="zmniejszanie-lvm">Zmniejszanie LVM</h3>
<p>Odmontowanie logicznego wolumena zamontowanego w katalogu lvm:</p>
<pre class="lang:default highlight:0 decode:true">umount /lvm</pre>
<p>Zmniejszenie rozmiaru sytstemu plików do 32M</p>
<pre class="lang:default highlight:0 decode:true">resize2fs /dev/vdysk/part1 32M</pre>
<p>Zmiejszenie rozmiaru partycji do 32M</p>
<pre class="lang:default highlight:0 decode:true">lvreduce -L 32 /dev/vdysk/part1
mount /dev/vdysk/part1 /lvm</pre>
<h3 id="dodawanie-dodatkowej-partycjimiejsca-do-volumen-grupy">Dodawanie dodatkowej partycji/miejsca do volumen grupy</h3>
<pre class="lang:default highlight:0 decode:true">pvcreate /dev/sda4
vgextend vdysk /dev/sda4</pre>
<h3 id="zmniejszanie-wielkości-partycji">Zmniejszanie wielkości partycji</h3>
<pre>pvresize /dev/sda2 --setphysicalvolumesize 50G</pre>
<h3 id="odłączenie-dysku-od-grupy">Odłączenie dysku od grupy</h3>
<p>(pvmove – Przenosi dane na inne partycje dostępne w volum grupie)</p>
<pre class="lang:default highlight:0 decode:true">pvmove /dev/sda1</pre>
<p>Odłączenie /dev/sda1 z grupy vdysk:</p>
<pre class="lang:default highlight:0 decode:true">vgreduce vdysk /dev/sda1</pre>
<p>Usuniecie oznaczenia LVM z fizycznej partycji</p>
<pre class="lang:default highlight:0 decode:true">pvremove /dev/sda1</pre>
<h3 id="snapshot">Snapshot</h3>
<pre class="lang:default highlight:0 decode:true">lvcreate -L 12M -n snapszot -s /dev/vdysk/part1</pre>
<p> </p>
<h3 id="ćwiczenia-z-lvm">Ćwiczenia z LVM:</h3>
<h4 id="Zmniejszanie_dysku">Zmniejszanie dysku</h4>
<p>Przypuśćmy, że mamy maszynę na której mamy 180G dysk, dane zajmują 30G i musimy go zmniejszyć do rozmiarów 50G. Najszybciej było by można dodać drugi dysk o rozmiarach 50G i podłączyć pod Volumen Grupę i przesunąć dane na nową mniejszą partycję. A starą 180G usunąć. I tak własnie zaraz zrobię.</p>
<pre>[root@baza01 ~]# lvs
 LV VG Attr LSize Pool Origin Data% Move Log Copy% Convert
 vg_DB vg_HDD1 -wi-ao-- 179,50g
 lv_home vg_produkcja -wi-ao-- 33,76g 
 lv_root vg_produkcja -wi-ao-- 50,00g 
 lv_swap vg_produkcja -wi-ao-- 15,75g</pre>
<pre>[root@baza01 ~]# pvs
 PV VG Fmt Attr PSize PFree 
 /dev/sda2 vg_produkcja lvm2 a-- 99,51g 0 
 /dev/sdb1 vg_HDD1 lvm2 a-- 180,00g 508,00m</pre>
<pre>[root@baza01 ~]# vgs
 VG #PV #LV #SN Attr VSize VFree 
 vg_HDD1 1 1 0 wz--n- 180,00g 508,00m
 vg_produkcja 1 3 0 wz--n- 99,51g 0</pre>
<pre>[root@baza01 ~]# fdisk /dev/sdc
 Urządzenie nie zawiera poprawnej DOS-owej tablicy partycji ani etykiety dysku Sun, SGI ani OSF
 Tworzenie nowej etykiety dysku typu DOS z identyfikatorem dysku 0x16358207.
 Zmiany pozostaną tylko w pamięci do chwili ich zapisania.
 Potem, oczywiście, poprzednia zawartość będzie nie do odzyskania.
 Uwaga: niepoprawna flaga 0x0000 tablicy partycji 4 będzie poprawiona przy zapisie (w)
 UWAGA: tryb kompatybilności z DOS-em jest przestarzały. Zdecydowanie
 zaleca się wyłączyć ten tryb (polecenie 'c') i zmienić jednostki
 wyświetlania na sektory (polecenie 'u').
 Polecenie (m wyświetla pomoc): p
 Dysk /dev/sdc: 53.7 GB, bajtów: 53687091200
 głowic: 255, sektorów/ścieżkę: 63, cylindrów: 6527
 Jednostka = cylindrów, czyli 16065 * 512 = 8225280 bajtów
 Rozmiar sektora (logiczny/fizyczny) w bajtach: 512 / 512
 Rozmiar we/wy (minimalny/optymalny) w bajtach: 512 / 512
 Identyfikator dysku: 0x16358207
 Urządzenie Rozruch Początek Koniec Bloków ID System
 Polecenie (m wyświetla pomoc): n
 Polecenie
 e partycja rozszerzona
 p partycja główna (1-4)
 Numer partycji (1-4): 1
 Pierwszy cylinder (1-6527, domyślnie 1):
 Przyjęto wartość domyślną 1
 Ostatni cylinder, +cylindrów lub +rozmiar{K,M,G} (1-6527, domyślnie 6527):
 Przyjęto wartość domyślną 6527
 Polecenie (m wyświetla pomoc): p
 Dysk /dev/sdc: 53.7 GB, bajtów: 53687091200
 głowic: 255, sektorów/ścieżkę: 63, cylindrów: 6527
 Jednostka = cylindrów, czyli 16065 * 512 = 8225280 bajtów
 Rozmiar sektora (logiczny/fizyczny) w bajtach: 512 / 512
 Rozmiar we/wy (minimalny/optymalny) w bajtach: 512 / 512
 Identyfikator dysku: 0x16358207
 Urządzenie Rozruch Początek Koniec Bloków ID System
 /dev/sdc1 1 6527 52428096 83 Linux
 Polecenie (m wyświetla pomoc): w
 Tablica partycji została zmodyfikowana!
 Wywoływanie ioctl() w celu ponownego odczytu tablicy partycji.
 Synchronizacja dysków.</pre>
<pre>[root@baza01 ~]# pvcreate /dev/sdc1
 Writing physical volume data to disk "/dev/sdc1"
 Physical volume "/dev/sdc1" successfully created</pre>
<pre>[root@baza01 ~]# vgextend vg_HDD1 /dev/sdc1
 Volume group "vg_HDD1" successfully extended</pre>
<pre>[root@baza01 ~]# umount /DB</pre>
<pre>[root@baza01 ~]# e2fsck -f /dev/vg_HDD1/vg_DB
 e2fsck 1.41.12 (17-May-2010)
 Przebieg 1: Sprawdzanie i-węzłów, bloków i rozmiarów
 Przebieg 2: Sprawdzanie struktury katalogów
 Przebieg 3: Sprawdzanie łączności katalogów
 Przebieg 4: Sprawdzanie liczników odwołań
 Przebieg 5: Sprawdzanie sumarycznych informacji o grupach
 /dev/vg_HDD1/vg_DB: 2445/11763712 plików (42.2% nieciągłych), 7459456/47054848 bloków</pre>
<pre>[root@baza01 ~]# resize2fs /dev/vg_HDD1/vg_DB 49G
 resize2fs 1.41.12 (17-May-2010)
 Zmiana rozmiaru systemu plików /dev/vg_HDD1/vg_DB na 12845056 (4k) bloków.
 System plików na /dev/vg_HDD1/vg_DB ma teraz 12845056 bloków.</pre>
<pre>[root@baza01 ~]# lvreduce -L 49G /dev/vg_HDD1/vg_DB
 WARNING: Reducing active logical volume to 49,00 GiB
 THIS MAY DESTROY YOUR DATA (filesystem etc.)
 Do you really want to reduce vg_DB? [y/n]: y
 Reducing logical volume vg_DB to 49,00 GiB
 Logical volume vg_DB successfully resized</pre>
<pre>[root@baza01 ~]# lvs
 LV VG Attr LSize Pool Origin Data% Move Log Copy% Convert
 vg_DB vg_HDD1 -wi-a--- 49,00g
 lv_home vg_produkcja -wi-ao-- 33,76g
 lv_root vg_produkcja -wi-ao-- 50,00g
 lv_swap vg_produkcja -wi-ao-- 15,75g</pre>
<pre>[root@baza01 ~]# pvs
 PV VG Fmt Attr PSize PFree
 /dev/sda2 vg_produkcja lvm2 a-- 99,51g 0
 /dev/sdb1 vg_HDD1 lvm2 a-- 180,00g 131,00g
 /dev/sdc1 vg_HDD1 lvm2 a-- 50,00g 50,00g</pre>
<pre>[root@baza01 ~]# pvresize /dev/sdb1 --setphysicalvolumesize 50G
 Physical volume "/dev/sdb1" changed
 1 physical volume(s) resized / 0 physical volume(s) not resized</pre>
<pre>[root@baza01 ~]# pvs
 PV VG Fmt Attr PSize PFree
 /dev/sda2 vg_produkcja lvm2 a-- 99,51g 0
 /dev/sdb1 vg_HDD1 lvm2 a-- 50,00g 1020,00m
 /dev/sdc1 vg_HDD1 lvm2 a-- 50,00g 50,00g</pre>
<pre>[root@baza01 ~]# pvmove /dev/sdb1
 /dev/sdb1: Moved: 0,0%
 /dev/sdb1: Moved: 1,1%
 /dev/sdb1: Moved: 20,7%
 /dev/sdb1: Moved: 48,2%
 /dev/sdb1: Moved: 60,9%
 /dev/sdb1: Moved: 77,9%
 /dev/sdb1: Moved: 93,1%
 /dev/sdb1: Moved: 100,0%</pre>
<pre>[root@baza01 ~]# vgreduce vg_HDD1 /dev/sdb1
 Removed "/dev/sdb1" from volume group "vg_HDD1"</pre>
<pre>[root@baza01 ~]# pvremove /dev/sdb1
 Labels on physical volume "/dev/sdb1" successfully wiped</pre>
<pre>[root@baza01 ~]# df -h
 System plików rozm. użyte dost. %uż. zamont. na
 /dev/mapper/vg_produkcja-lv_root
 50G 30G 18G 63% /
 tmpfs 7,8G 0 7,8G 0% /dev/shm
 /dev/sda1 485M 69M 391M 15% /boot
 /dev/mapper/vg_produkcja-lv_home
 34G 2,3G 30G 8% /home</pre>
<pre>[root@baza01 ~]# mount -a</pre>
<pre>[root@baza01 ~]# df -h
 System plików rozm. użyte dost. %uż. zamont. na
 /dev/mapper/vg_produkcja-lv_root
 50G 30G 18G 63% /
 tmpfs 7,8G 0 7,8G 0% /dev/shm
 /dev/sda1 485M 69M 391M 15% /boot
 /dev/mapper/vg_produkcja-lv_home
 34G 2,3G 30G 8% /home
 /dev/mapper/vg_HDD1-vg_DB
 49G 26G 21G 56% /DB</pre>
<h4 id="Rozszerzanie_dodawanie_nowego_dysku_do_wolumen_grupy">Rozszerzanie / dodawanie nowego dysku do wolumen grupy</h4>
<p>Mamy sytuację że mamy produkcyjną maszynę na VMware na której kończy się miejsce na dysku. Zadanie jest takie aby dodać nowy dysk i nie restartować maszyny bo mieli ważne dane.</p>
<p>Pierwsze co admin pomyśli po dodaniu dysku to czy system go zobaczy. Od razu nie zobaczy ale wystarczy przeskanować /sys/class/scsi_host i nowy dysk powinien się pojawić.</p>
<pre>[root@produkcja ~]# ls /sys/class/scsi_host/
host0 host1 host2
 [root@produkcja ~]#echo - - - &gt; /sys/class/scsi_host/host0/scan
 [root@produkcja ~]#echo - - - &gt; /sys/class/scsi_host/host1/scan
 [root@produkcja ~]#echo - - - &gt; /sys/class/scsi_host/host2/scan</pre>
<p>lub zastosować skrypt</p>
<pre>#! /bin/bash
 host=`ls /sys/class/scsi_host/`
 for i in $host
 do
 echo - - - &gt; /sys/class/scsi_host/$i/scan
 done</pre>
<p>Pojawił się dysk 70G</p>
<pre>[root@produkcja ~]# fdisk -l
Dysk /dev/sdc: 75.2 GB, bajtów: 75161927680
głowic: 255, sektorów/ścieżkę: 63, cylindrów: 9137
Jednostka = cylindrów, czyli 16065 * 512 = 8225280 bajtów
Rozmiar sektora (logiczny/fizyczny) w bajtach: 512 / 512
Rozmiar we/wy (minimalny/optymalny) w bajtach: 512 / 512
Identyfikator dysku: 0x00000000</pre>
<p>Upewniam się czy ten dysk na pewno nigdzie nie został przydzielony</p>
<pre>[root@produkcja ~]# pvs
 PV VG Fmt Attr PSize PFree 
 /dev/sda2 vg_produkcja lvm2 a-- 99,51g 0 
 /dev/sdb1 vg_baza lvm2 a-- 50,00g 1020,00m</pre>
<p>Nowy dysk /dev/sdc Nigdzie nie należy więc tworzę partycję</p>
<pre>[root@produkcja ~]# fdisk /dev/sdc
 Urządzenie nie zawiera poprawnej DOS-owej tablicy partycji ani etykiety dysku Sun, SGI ani OSF
 Tworzenie nowej etykiety dysku typu DOS z identyfikatorem dysku 0xb4f1510c.
 Zmiany pozostaną tylko w pamięci do chwili ich zapisania.
 Potem, oczywiście, poprzednia zawartość będzie nie do odzyskania.
 Uwaga: niepoprawna flaga 0x0000 tablicy partycji 4 będzie poprawiona przy zapisie (w)
 UWAGA: tryb kompatybilności z DOS-em jest przestarzały. Zdecydowanie
 zaleca się wyłączyć ten tryb (polecenie 'c') i zmienić jednostki
 wyświetlania na sektory (polecenie 'u').
 Polecenie (m wyświetla pomoc): p
 Dysk /dev/sdc: 75.2 GB, bajtów: 75161927680
 głowic: 255, sektorów/ścieżkę: 63, cylindrów: 9137
 Jednostka = cylindrów, czyli 16065 * 512 = 8225280 bajtów
 Rozmiar sektora (logiczny/fizyczny) w bajtach: 512 / 512
 Rozmiar we/wy (minimalny/optymalny) w bajtach: 512 / 512
 Identyfikator dysku: 0xb4f1510c
 Urządzenie Rozruch Początek Koniec Bloków ID System
 Polecenie (m wyświetla pomoc): n
 Polecenie
 e partycja rozszerzona
 p partycja główna (1-4)
p
 Numer partycji (1-4): 1
 Pierwszy cylinder (1-9137, domyślnie 1):
 Przyjęto wartość domyślną 1
 Ostatni cylinder, +cylindrów lub +rozmiar{K,M,G} (1-9137, domyślnie 9137):
 Przyjęto wartość domyślną 9137
 Polecenie (m wyświetla pomoc): p
 Dysk /dev/sdc: 75.2 GB, bajtów: 75161927680
 głowic: 255, sektorów/ścieżkę: 63, cylindrów: 9137
 Jednostka = cylindrów, czyli 16065 * 512 = 8225280 bajtów
 Rozmiar sektora (logiczny/fizyczny) w bajtach: 512 / 512
 Rozmiar we/wy (minimalny/optymalny) w bajtach: 512 / 512
 Identyfikator dysku: 0xb4f1510c
 Urządzenie Rozruch Początek Koniec Bloków ID System
 /dev/sdc1 1 9137 73392921 83 Linux
 Polecenie (m wyświetla pomoc): w
 Tablica partycji została zmodyfikowana!
 Wywoływanie ioctl() w celu ponownego odczytu tablicy partycji.
 Synchronizacja dysków.</pre>
<p>Tworzę nowy fizyczny wolumen</p>
<pre>[root@produkcja ~]# pvcreate /dev/sdc1
 Writing physical volume data to disk "/dev/sdc1"
 Physical volume "/dev/sdc1" successfully created</pre>
<p>Wyświetlam fizyczne wolumeny</p>
<pre>[root@produkcja ~]# pvs
 PV VG Fmt Attr PSize PFree 
 /dev/sda2 vg_produkcja lvm2 a-- 99,51g 0 
 /dev/sdb1 vg_baza lvm2 a-- 50,00g 1020,00m
 /dev/sdc1 lvm2 a-- 69,99g 69,99g</pre>
<p>Rozszerzam wolumen grupę o nowy fizyczny wolumen</p>
<pre>[root@produkcja ~]# vgextend vg_baza /dev/sdc1
 Volume group "vg_baza" successfully extended</pre>
<p>Sprawdzam czy fizyczny wolumen jest przypisany do wolumen grupy</p>
<pre>[root@produkcja ~]# pvs
 PV VG Fmt Attr PSize PFree 
 /dev/sda2 vg_produkcja lvm2 a-- 99,51g 0 
 /dev/sdb1 vg_baza lvm2 a-- 50,00g 1020,00m
 /dev/sdc1 vg_baza lvm2 a-- 69,99g 69,99g</pre>
<p>Wyświetlam logiczne volumeny aby wiedzieć jaki mam rozszerzyć.</p>
<pre>[root@produkcja ~]# lvs
 LV VG Attr LSize Pool Origin Data% Move Log Copy% Convert
 vg_DB vg_baza -wi-ao-- 49,00g 
 lv_home vg_produkcja -wi-ao-- 33,76g 
 lv_root vg_produkcja -wi-ao-- 50,00g 
 lv_swap vg_produkcja -wi-ao-- 15,75g</pre>
<p>Rozszerzam o 70G logiczny wolumen</p>
<pre>[root@produkcja ~]# lvextend -L +70G /dev/vg_baza/vg_DB 
 Extending logical volume vg_DB to 119,00 GiB
 Logical volume vg_DB successfully resized</pre>
<p>Sprawdzam wielkość zamontowanej partycji. Tu jeszcze będzie stara wartość.</p>
<pre>[root@produkcja ~]# df -h
System plików rozm. użyte dost. %uż. zamont. na
/dev/mapper/vg_produkcja-lv_root  50G 29G 19G 61% /
tmpfs 7,8G 0 7,8G 0% /dev/shm 
/dev/sda1 485M 69M 391M 15% /boot
/dev/mapper/vg_produkcja-lv_home  34G 7,8G 24G 25% /home
/dev/mapper/vg_baza-vg_DB  49G 26G 21G 56% /baza</pre>
<p>Rozszerzam system plików, jeśli system plików to XFS zamień komendę resize2fs na fsadm resize</p>
<pre>[root@produkcja ~]# resize2fs /dev/vg_baza/vg_DB 
resize2fs 1.41.12 (17-May-2010)
System plików /dev/vg_baza/vg_DB jest zamontowany pod /dsdb; wymagana zmiana rozmiaru w locie
old desc_blocks = 4, new_desc_blocks = 8
Wykonywanie zmiany rozmiaru w locie /dev/vg_baza/vg_DB na 31195136 (4k) bloków.
System plików na /dev/vg_baza/vg_DB ma teraz 31195136 bloków.</pre>
<p>Sprawdzam wielkość zamontowanej partycji. Tu już będzie nowa wartość 118G</p>
<pre>[root@produkcja ~]# df -h
System plików rozm. użyte dost. %uż. zamont. na
/dev/mapper/vg_produkcja-lv_root
 50G 29G 19G 61% /
tmpfs 7,8G 0 7,8G 0% /dev/shm
/dev/sda1 485M 69M 391M 15% /boot
/dev/mapper/vg_produkcja-lv_home  34G 7,8G 24G 25% /home
/dev/mapper/vg_baza-vg_DB  118G 26G 86G 24% /dsdb</pre>
<p> </p>
      <ul class="flex list-none mt-20 ml-0 p-0">
  
   <li class="mr-3">
     <a class="px-4 py-2" href="/tags/bash">
       bash
     </a>
   </li>
  
   <li class="mr-3">
     <a class="px-4 py-2" href="/tags/lvm">
       lvm
     </a>
   </li>
  
   <li class="mr-3">
     <a class="px-4 py-2" href="/tags/vmware">
       vmware
     </a>
   </li>
  
</ul>

    </section>

    <div class="mt-20">


</div>
  </article>
</main>
  <footer class="container mt-20 py-10 border-t border-gray-700">
    <a class="flex items-center flex-wrap" rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
  <span class="pr-2">
  This work is licensed under CC BY-SA 4.0
  </span>
  
  <svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   width="22px"
   height="22px"
   viewBox="0 0 268.90738 268.90381"
   version="1.1"
   id="svg8">
  <defs
     id="defs2" />
  <metadata
     id="metadata5">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <g
     id="layer1"
     transform="translate(60.21326,50.499404)"
     style="fill:#cccccc">
    <path
       style="fill:#cccccc;stroke-width:0.264583"
       d="m 65.326548,218.13993 c -7.408989,-0.46542 -15.690447,-1.74744 -23.081418,-3.57314 -31.593648,-7.80417 -59.50341,-27.196 -78.984789,-54.879 -12.666454,-17.999 -20.584652,-39.56079 -22.979215,-62.573955 -0.588773,-5.658461 -0.669383,-19.38408 -0.146066,-24.870832 3.119592,-32.707523 16.59157,-61.003391 40.247757,-84.534371 15.2616153,-15.18084 31.549653,-25.40687 50.36784,-31.622169 9.975312,-3.29466 18.955768,-5.117077 30.871725,-6.264843 5.078285,-0.48915 20.860791,-0.402168 26.193748,0.144361 17.33888,1.776911 31.24054,5.591623 45.38445,12.4538 13.95995,6.772926 25.0448,14.737531 36.65278,26.335482 7.30053,7.294229 12.4089,13.497668 17.32958,21.0444786 14.76407,22.6435694 22.22029,49.6275974 21.45807,77.6568024 -0.46871,17.235696 -3.45781,32.378206 -9.34888,47.360416 -7.49661,19.06545 -19.6155,35.81838 -36.29386,50.17195 -27.31891,23.51094 -62.27286,35.37477 -97.671722,33.15102 z m 13.890624,-24.58696 c 15.841765,-0.76807 29.708118,-4.37941 44.185418,-11.50762 19.6139,-9.65733 37.13415,-25.89003 47.43961,-43.95329 6.96873,-12.21469 10.946,-24.7316 12.93683,-40.713641 0.67104,-5.386914 0.66827,-21.171823 -0.005,-26.590624 C 180.44549,43.981851 168.68756,20.905587 149.16032,2.8538209 130.13808,-14.731106 108.6227,-24.146325 83.053631,-26.074732 c -5.193633,-0.391701 -17.404794,-0.161974 -22.092708,0.415627 -10.285637,1.267301 -17.71031,3.035425 -26.228057,6.245993 -29.9817139,11.3009174 -56.047005,39.477533 -65.941823,71.2832 -3.208777,10.314217 -4.489061,18.317852 -4.719883,29.506144 -0.208211,10.092276 0.47345,17.242929 2.4713,25.924058 5.622303,24.43025 19.636401,46.44843 39.7820077,62.5033 18.1256193,14.44505 39.8519053,22.67019 62.7062473,23.73934 2.255572,0.10551 4.279635,0.20867 4.497916,0.22922 0.218281,0.0206 2.778125,-0.0781 5.688541,-0.21918 z M 30.118038,125.15173 C 21.434959,123.79805 14.347465,120.33213 8.6867364,114.6714 1.3325742,107.31724 -2.4067819,96.984367 -2.4067819,84.016961 c 0,-8.085137 1.5872327,-15.633104 4.5106217,-21.449926 C 5.4861963,55.83698 12.3068,49.171317 19.11187,45.945369 c 5.23178,-2.48013 9.591952,-3.455662 16.334628,-3.654661 10.82623,-0.319518 18.524856,1.624447 25.857645,6.529271 3.902054,2.61004 7.896228,6.879878 10.578412,11.308498 l 0.835324,1.379219 -2.703478,1.434338 c -6.151456,3.263673 -15.039649,7.845608 -15.215139,7.843528 -0.103587,-0.0013 -0.605057,-0.80305 -1.11438,-1.781828 -1.356468,-2.606757 -4.590515,-5.79732 -7.14375,-7.047696 -2.685235,-1.315019 -4.460541,-1.74471 -7.22381,-1.748435 -7.952604,-0.01072 -13.378049,3.987215 -15.901505,11.717607 -2.048417,6.275159 -2.048491,17.061121 -1.58e-4,23.178173 2.234617,6.673367 6.42223,10.903017 11.955673,12.075697 3.975534,0.84251 9.523997,0.30321 12.537453,-1.21863 3.04397,-1.53725 5.77738,-4.36532 7.552962,-7.814528 l 0.980212,-1.904137 8.146462,4.074875 c 4.617427,2.30964 8.14646,4.22877 8.14646,4.43012 0,0.19539 -0.850363,1.65353 -1.889696,3.24032 -2.416302,3.68905 -7.205178,8.53786 -10.781707,10.91664 -4.746985,3.15726 -9.846024,5.19842 -15.334575,6.13848 -3.582267,0.61356 -11.020075,0.66931 -14.610865,0.10951 z M 109.37967,125.39 c -9.967707,-1.44914 -16.885196,-4.67736 -22.886456,-10.68056 -6.35757,-6.35962 -9.881743,-14.63917 -10.86812,-25.533104 -0.395735,-4.370652 -0.163393,-10.37091 0.568608,-14.684374 2.778691,-16.374044 13.793641,-28.073013 29.696538,-31.540669 2.35918,-0.514426 3.48834,-0.588761 9.04568,-0.595492 5.08055,-0.0062 6.87894,0.09037 8.99583,0.482862 8.18481,1.517523 14.16373,4.460118 19.41412,9.554876 2.48277,2.409169 4.711,5.220872 6.22954,7.86076 l 0.71355,1.240459 -0.61089,0.379408 c -0.75824,0.470913 -16.82726,8.913629 -16.96531,8.913629 -0.0551,0 -0.71109,-0.999651 -1.45771,-2.221447 -1.98393,-3.246591 -4.06947,-5.213273 -7.0223,-6.622071 -3.00807,-1.435158 -4.28275,-1.741035 -7.23118,-1.735222 -11.53755,0.02276 -17.516019,8.036496 -17.538609,23.509366 -0.01246,8.543372 2.160459,15.372349 6.170589,19.392629 1.76767,1.77214 3.20485,2.68168 5.69886,3.60656 2.412,0.89448 7.50413,1.12157 10.45053,0.46605 4.87189,-1.08389 8.65425,-4.09612 11.21874,-8.934495 0.44034,-0.830776 0.84629,-1.647526 0.90212,-1.815002 0.061,-0.182935 3.42501,1.356098 8.42618,3.854957 4.57858,2.2877 8.36683,4.19831 8.41833,4.24579 0.0515,0.0475 -0.58827,1.13561 -1.42171,2.41805 -6.02946,9.27767 -15.04318,15.5516 -25.79172,17.95213 -1.43309,0.32005 -3.56472,0.465 -7.67292,0.52174 -3.1287,0.0432 -6.04573,0.0266 -6.48229,-0.0368 z"
       id="path76" />
  </g>
</svg>

  <svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   width="22px"
   height="22px"
   viewBox="0 0 269.00082 268.82538"
   version="1.1"
   id="svg8">
  <defs
     id="defs2" />
  <metadata
     id="metadata5">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <g
     id="layer1"
     transform="translate(277.24967,233.43254)"
     style="fill:#cccccc">
    <path
       style="fill:#cccccc;stroke-width:0.264583"
       d="m -149.88812,35.335792 c -9.54812,-0.709586 -13.43497,-1.182581 -19.57917,-2.382625 -25.64662,-5.009092 -49.13885,-17.949542 -68.98407,-37.9991525 -26.5694,-26.8430445 -39.77044,-60.0909305 -38.74258,-97.5763345 0.71419,-26.04584 7.61271,-48.56922 21.27127,-69.44973 11.3033,-17.27992 27.54285,-33.0769 44.37171,-43.16244 17.0419,-10.21323 34.85965,-15.87487 56.23888,-17.87006 4.68105,-0.43685 19.92301,-0.43746 24.87083,-9.9e-4 23.29546,2.05501 43.440152,8.87006 61.515625,20.81106 8.102536,5.35269 13.871899,10.1228 21.576764,17.83965 5.840177,5.84927 9.406276,9.91973 13.50451,15.4145 11.558431,15.49712 19.429002,33.37935 23.095227,52.47322 2.6321011,13.70807 3.2228099,30.196009 1.5972099,44.582293 -3.0618639,27.097449 -13.1312699,50.106479 -30.6840929,70.11458 -3.424504,3.9035244 -11.778649,12.04028701 -15.860452,15.4477524 -22.390327,18.6913166 -45.839771,28.5376896 -74.744791,31.3851616 -2.83124,0.278924 -17.04496,0.55163 -19.44687,0.373115 z m 21.70063,-25.212864 c 24.81471,-3.3936646 44.731952,-13.3669 63.986079,-32.039998 16.741491,-16.236285 26.870384,-35.742616 30.300437,-58.352914 1.089226,-7.179971 1.215977,-9.117986 1.219647,-18.648166 0.0037,-9.58791 -0.126844,-11.56948 -1.22877,-18.65312 -4.1636,-26.76532 -18.047795,-50.14601 -40.571778,-68.32203 -15.945913,-12.86775 -33.076085,-19.981 -54.768745,-22.74252 -5.26911,-0.67077 -21.10365,-0.67315 -26.45833,-0.004 -22.46437,2.80738 -39.58177,10.14944 -56.62083,24.28604 -3.60054,2.98721 -11.05809,10.50314 -14.40229,14.51504 -14.6489,17.57365 -22.53661,35.17132 -25.44148,56.76056 -0.69804,5.18785 -0.97446,17.14732 -0.52615,22.764069 1.50416,18.845411 7.19231,35.336288 17.4749,50.662595 7.2509,10.807551 18.27366,22.280127 28.79336,29.9683603 15.54468,11.3607051 33.48114,18.3126609 51.64853,20.0183427 1.67349,0.15712 3.45942,0.332922 3.96875,0.390675 0.50932,0.05775 4.91463,0.06798 9.78958,0.02273 7.13,-0.06618 9.64069,-0.188553 12.83709,-0.625695 z m -35.39178,-54.867643 -0.0672,-32.609894 -7.74703,-0.07015 -7.74703,-0.07015 0.076,-28.372551 c 0.0875,-32.6577 -0.14933,-29.79422 2.69722,-32.60839 2.77504,-2.74348 -0.18284,-2.53055 34.02447,-2.44937 l 29.76091,0.0706 1.40323,0.77737 c 1.74934,0.9691 3.08144,2.42332 3.98496,4.35026 l 0.69722,1.48696 0.0741,28.37255 0.0741,28.372551 -7.74703,0.07015 -7.74703,0.07015 -0.0672,32.609894 -0.0672,32.609894 h -20.76771 -20.76771 z m 15.54323,-104.048245 c -7.65008,-1.44557 -11.96298,-6.02587 -13.11908,-13.93246 -0.39276,-2.68616 -0.16692,-8.71288 0.41469,-11.0658 1.47824,-5.9803 5.56009,-10.02954 11.65337,-11.56027 2.6088,-0.65538 10.07658,-0.65538 12.68538,0 6.09328,1.53073 10.17513,5.57997 11.65337,11.56027 0.5816,2.35292 0.80745,8.37964 0.41468,11.0658 -1.1831,8.09126 -5.79498,12.79495 -13.78053,14.05486 -2.34301,0.36966 -7.66531,0.304 -9.92188,-0.1224 z"
       id="path162" />
  </g>
</svg>

  <svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   width="22px"
   height="22px"
   viewBox="0 0 269.69287 269.58087"
   version="1.1"
   id="svg8">
  <defs
     id="defs2" />
  <metadata
     id="metadata5">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <g
     id="layer1"
     transform="translate(286.69733,236.4116)"
     style="fill:#cccccc">
    <path
       style="fill:#cccccc;stroke-width:0.264583"
       d="m -161.30298,33.024602 c -33.09048,-2.275337 -61.53656,-15.421337 -85.85925,-39.6787667 -23.13623,-23.0741553 -35.77499,-49.4397933 -39.06422,-81.4916623 -0.56025,-5.459325 -0.63923,-20.351693 -0.13611,-25.664583 2.18732,-23.0978 8.90609,-42.53156 21.11666,-61.07911 13.49749,-20.50234 32.53491,-37.66786 53.33663,-48.09219 12.39138,-6.20967 27.03633,-10.63756 40.949,-12.38089 7.27382,-0.91145 9.8864,-1.05528 19.05,-1.0488 9.76011,0.007 13.94787,0.28323 21.68076,1.43061 26.86175,3.98566 50.854862,15.72696 70.728144,34.61162 12.967099,12.32204 22.118798,24.5019 29.154619,38.80147 4.159358,8.45345 6.787467,15.61203 9.148174,24.91826 5.69259,22.44084 5.585037,48.926081 -0.290168,71.460859 -6.55125,25.127756 -20.299915,46.815711 -41.256953,65.08113634 C -79.294349,14.315783 -97.807112,24.118974 -118.04361,29.174835 c -6.92617,1.730428 -13.31731,2.802282 -21.43125,3.594259 -3.87689,0.378407 -17.68934,0.540094 -21.82812,0.255508 z m 22.35729,-24.9728262 c 19.96596,-2.3357495 37.32835,-9.3539755 53.44583,-21.6038688 8.120806,-6.172117 16.051624,-13.895312 22.071422,-21.493598 12.226789,-15.432854 19.150718,-32.788493 21.500646,-53.893886 0.643308,-5.777741 0.645136,-19.426513 0.0034,-25.135413 -2.266039,-20.15775 -8.649808,-36.85369 -19.929413,-52.12292 -5.168206,-6.9962 -13.213839,-15.47523 -20.338723,-21.4343 -19.497682,-16.30735 -42.912242,-24.60104 -69.453122,-24.60104 -32.33809,0 -59.59141,12.15458 -81.43834,36.32031 -9.54048,10.5531 -16.41628,21.18795 -21.47607,33.2172 -7.9215,18.83276 -10.03228,41.93248 -5.78242,63.281162 1.816,9.122476 4.37185,16.555923 8.68781,25.267707 5.27044,10.638417 11.33919,19.154904 20.21348,28.366296 19.8649,20.6194804 43.26805,31.9241944 70.80483,34.2017461 4.18379,0.346038 17.516,0.1189884 21.69071,-0.3693953 z m -22.35729,-35.9004698 c -18.34463,-2.20681 -34.20388,-12.042565 -43.04677,-26.697208 -4.02402,-6.668696 -7.24408,-16.082073 -8.30325,-24.273363 l -0.17961,-1.389063 h 16.96742 c 13.39715,0 16.96757,0.06959 16.96816,0.330729 5.3e-4,0.181901 0.13207,1.402292 0.29256,2.711979 0.40015,3.26525 1.35402,6.396038 2.81645,9.244108 1.56856,3.054765 4.97243,6.573519 8.00275,8.272845 2.50661,1.405644 6.76894,2.834868 10.18709,3.415885 3.3438,0.56838 11.44552,0.657132 13.7577,0.150715 5.83319,-1.277602 10.18482,-3.720688 14.2658,-8.009094 5.82522,-6.121317 9.47131,-14.391747 11.18792,-25.377583 0.38424,-2.459035 0.47544,-4.666845 0.47544,-11.509376 0,-8.65642 -0.15326,-10.67496 -1.21909,-16.05548 -2.68108,-13.53473 -9.23491,-22.43163 -19.02153,-25.82193 -3.71776,-1.28791 -5.43951,-1.51639 -11.24479,-1.49221 -4.6017,0.0192 -5.70565,0.10962 -8.46667,0.69374 -9.34786,1.97762 -15.22863,6.49582 -18.7228,14.38474 -0.68373,1.54367 -1.81825,5.514 -2.16813,7.5875 l -0.16742,0.99218 h 4.97194 4.97195 l -13.3595,13.36147 -13.3595,13.36146 -13.29791,-13.29532 -13.2979,-13.29531 5.22133,-0.1323 5.22133,-0.13229 0.20605,-1.32291 c 0.44498,-2.85704 1.91678,-8.63464 3.03302,-11.90625 7.3673,-21.59293 25.0818,-35.64201 48.234,-38.2536 3.96056,-0.44676 13.14464,-0.36926 17.59479,0.14847 13.45124,1.56491 24.65795,6.06575 34.13256,13.70832 2.88324,2.32572 8.33265,7.99891 10.668208,11.1063 7.586871,10.09407 11.983783,21.16366 13.949335,35.11863 0.58719,4.16892 0.813215,16.101234 0.391986,20.693895 -1.18622,12.933413 -5.001025,24.079699 -11.629445,33.979505 -6.849974,10.230707 -15.360274,17.842414 -25.643104,22.935492 -6.44958,3.194468 -12.65867,5.129411 -20.23855,6.306942 -4.00262,0.621808 -16.44134,0.904742 -20.15182,0.458382 z"
       id="path344" />
  </g>
</svg>

</a>

  </footer>
</body>

</html>
